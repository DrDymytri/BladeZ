<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart - Point FX BladeZ</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="admin.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jacquard+24&family=MedievalSharp&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
  </head>
  <body>
    <header>
      <div class="logo-container">
        <img src="./Images/Logo only.gif" alt="Logo" class="responsive-logo" />
      </div>
      <h1 class="businessName">Point FX BladeZ</h1>
      <nav>
        <ul class="responsive-nav">
          <li>
            <a href="index.html"><i class="fas fa-home"></i> Product Catalog</a>
          </li>
          <li>
            <a href="checkout.html"><i class="fas fa-credit-card"></i> Checkout</a>
          </li>
          <li>
            <a href="orders.html"><i class="fas fa-box"></i> My Orders</a>
          </li>
        </ul>
      </nav>
    </header>
    <main>
      <section id="cart-section">
        <h2>Your Cart</h2>
        <div id="cart-container" class="product-cards-container">
          <!-- Product cards will be dynamically loaded here -->
        </div>
        <div id="cart-summary">
          <h3>Cart Summary</h3>
          <table id="cart-summary-table">
            <thead>
              <tr>
                <th>Product</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <!-- Cart summary rows will be dynamically inserted here -->
            </tbody>
          </table>
          <p><strong>Grand Total: $<span id="cart-total">0.00</span></strong></p>
          <button id="clear-cart-btn">Clear Cart</button>
          <a href="checkout.html" class="checkout-button">Proceed to Checkout</a>
        </div>
        <script src="cart.js"></script> <!-- Ensure this file exists in the same directory -->
        <script>
          // Removed authentication validation logic
          const userId = 1; // Replace with the actual logged-in user ID

          document.getElementById("clear-cart-btn").addEventListener("click", async () => {
            try {
              const response = await fetch(`/api/cart?user_id=${userId}`);
              const cartItems = await response.json();

              // Remove each item from the cart
              for (const item of cartItems) {
                await fetch(`/api/cart/${item.cart_id}`, { method: "DELETE" });
              }

              alert("Cart cleared!");
              window.location.reload();
            } catch (error) {
              console.error("Error clearing cart:", error);
              alert("Failed to clear cart. Please try again.");
            }
          });
        </script>
      </section>
    </main>
    <footer>
      <p>&copy; 2025 Point FX BladeZ. All Rights Reserved.</p>
    </footer>
  </body>
</html>
